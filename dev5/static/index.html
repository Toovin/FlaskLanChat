<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEV Chat</title>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/lib/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/login.css">
    <link rel="stylesheet" href="/static/css/viewers.css">
    <link rel="stylesheet" href="/static/css/chat.css">
    <link rel="stylesheet" href="/static/css/sidebar.css">
    <link rel="stylesheet" href="/static/css/modals.css">
    <link rel="stylesheet" href="/static/css/members.css">
    <link rel="stylesheet" href="/static/css/reactions.css">
    <link rel="stylesheet" href="/static/css/polls.css">
    <link rel="stylesheet" href="/static/css/effects.css">
    <link rel="stylesheet" href="/static/css/user-settings.css">
</head>
<body>
    <div id="error-message" style="display: none; position: fixed; top: 10px; right: 10px; background: #dc3545; color: white; padding: 10px; border-radius: 4px; z-index: 1000;"></div>

    <div id="login-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Welcome to DEV Chat</h2>
            <p>Sign in or create an account</p>
            <form id="login-form">
                <div class="form-group">
                    <label for="username-input">Username</label>
                    <input type="text" id="username-input" name="username" required>
                </div>
            <div class="form-group">
                <label for="password-input">Password</label>
                <input type="password" id="password-input" name="password" required>
            </div>
            <div class="form-group" id="verify-password-group" style="display: none;">
                <label for="verify-password-input">Verify Password</label>
                <input type="password" id="verify-password-input" name="verify_password">
            </div>
            <div class="form-group">
                <label for="avatar-input">Avatar (optional)</label>
                <input type="file" id="avatar-input" name="avatar" accept="image/*">
            </div>
                <div class="form-actions button-container">
                    <button type="submit" id="login-button">Sign In</button>
                    <button type="submit" id="register-button">Create Account</button>
                </div>
            </form>
        </div>
    </div>

    <div id="loading-spinner" class="spinner">Loading...</div>

    <div id="image-gen-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Generate Image</h2>
            <form id="image-gen-form" action="javascript:void(0)">
                <div class="form-group">
                    <label for="prompt-input">Prompt</label>
                    <input type="text" id="prompt-input" name="prompt" placeholder="Enter image description">
                </div>
                <div class="form-group">
                    <label for="batch-size-input">Batch Size (1‚Äì4)</label>
                    <input type="number" id="batch-size-input" name="batch_size" min="1" max="4" value="1">
                </div>
                <div class="form-group">
                    <label for="width-input">Width</label>
                    <input type="number" id="width-input" name="width" value="1024">
                </div>
                <div class="form-group">
                    <label for="height-input">Height</label>
                    <input type="number" id="height-input" name="height" value="1024">
                </div>
                <div class="form-group">
                    <label for="steps-input">Steps</label>
                    <input type="number" id="steps-input" name="steps" value="33">
                </div>
                <div class="form-group">
                    <label for="cfg-scale-input">CFG Scale</label>
                    <input type="number" id="cfg-scale-input" name="cfg_scale" step="0.1" value="7">
                </div>
                <div class="form-group">
                    <label for="clip-skip-input">Clip Skip</label>
                    <input type="number" id="clip-skip-input" name="clip_skip" value="2">
                </div>
                <div class="form-group">
                    <label for="negative-prompt-input">Negative Prompt</label>
                    <input type="text" id="negative-prompt-input" name="negative_prompt" placeholder="Enter negative prompt">
                </div>
                <div class="form-group">
                    <label for="sampler-name-input">Sampler</label>
                    <select id="sampler-name-input" name="sampler_name"></select>
                </div>
                <div class="form-group">
                    <label for="scheduler-name-input">Scheduler</label>
                    <select id="scheduler-name-input" name="scheduler_name"></select>
                </div>
                <div class="form-actions">
                    <button type="submit">Generate Image</button>
                    <button type="button" class="cancel-button">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="create-channel-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Create Channel</h2>
            <form id="create-channel-form" action="javascript:void(0)">
                <div class="form-group">
                    <label for="channel-name-input">Channel Name</label>
                    <input type="text" id="channel-name-input" name="name" placeholder="Enter channel name" required>
                    <small>Channel names must be lowercase and contain no spaces</small>
                </div>
                <div class="form-actions">
                    <button type="submit">Create Channel</button>
                    <button type="button" class="cancel-button">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="create-folder-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Create New Folder</h2>
            <form id="create-folder-form" action="javascript:void(0)">
                <div class="form-group">
                    <label for="folder-name-input">Folder Name</label>
                    <input type="text" id="folder-name-input" name="name" placeholder="Enter folder name" required>
                    <small>Folder names cannot contain: / \ : * ? " < > |</small>
                </div>
                <div class="form-group">
                    <label for="folder-parent-select">Parent Folder</label>
                    <select id="folder-parent-select" name="parent_id">
                        <option value="">Share (Root)</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit">Create Folder</button>
                    <button type="button" class="cancel-button">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="user-settings-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <button class="close-modal" onclick="closeUserSettings()">&times;</button>
            <h2>User Settings</h2>

            <div class="settings-tabs">
                <div class="settings-tab active" data-tab="profile">Profile</div>
                <div class="settings-tab" data-tab="appearance">Appearance</div>
                <div class="settings-tab" data-tab="privacy">Privacy</div>
            </div>

            <div id="settings-tab-profile" class="settings-tab-content">
                <div class="form-group">
                    <label>Current Avatar</label>
                    <div class="avatar-preview">
                        <img id="settings-current-avatar" src="/static/avatars/smile_1.png" alt="Current Avatar">
                    </div>
                </div>

                <div class="form-group">
                    <label for="settings-avatar-input">Upload New Avatar</label>
                    <input type="file" id="settings-avatar-input" accept="image/*">
                    <small>Recommended: Square image, max 5MB</small>
                </div>

                <div class="form-group">
                    <label for="settings-display-name">Display Name</label>
                    <input type="text" id="settings-display-name" placeholder="Your display name">
                    <small>This is how others see your name</small>
                </div>

                <div class="form-group">
                    <label for="settings-status">Status</label>
                    <select id="settings-status">
                        <option value="online">Online</option>
                        <option value="away">Away</option>
                        <option value="busy">Do Not Disturb</option>
                        <option value="invisible">Invisible</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="settings-custom-status">Custom Status</label>
                    <input type="text" id="settings-custom-status" placeholder="What's happening?" maxlength="100">
                </div>
            </div>

             <div id="settings-tab-appearance" class="settings-tab-content" style="display: none;">
                 <div class="form-group">
                     <label>Theme</label>
                     <div class="theme-options">
                        <div class="theme-option" data-theme="light">
                            <div class="theme-preview light-theme"></div>
                            <span>Light</span>
                        </div>
                        <div class="theme-option" data-theme="dark">
                            <div class="theme-preview dark-theme"></div>
                            <span>Dark</span>
                        </div>
                        <div class="theme-option active" data-theme="darker">
                            <div class="theme-preview darker-theme"></div>
                            <span>Darker</span>
                        </div>
                        <div class="theme-option" data-theme="blue">
                            <div class="theme-preview blue-theme"></div>
                            <span>Blue</span>
                        </div>
                        <div class="theme-option" data-theme="purple">
                            <div class="theme-preview purple-theme"></div>
                            <span>Purple</span>
                        </div>
                        <div class="theme-option" data-theme="retro-green">
                            <div class="theme-preview retro-green-theme"></div>
                            <span>Retro Green</span>
                        </div>
                        <div class="theme-option" data-theme="ice-blue">
                            <div class="theme-preview ice-blue-theme"></div>
                            <span>Ice Blue</span>
                        </div>
                        <div class="theme-option" data-theme="pika-yellow">
                            <div class="theme-preview pika-yellow-theme"></div>
                            <span>Pika Yellow</span>
                        </div>
                        <div class="theme-option" data-theme="nature">
                            <div class="theme-preview nature-theme"></div>
                            <span>Nature</span>
                </div>
            </div>
            <div class="user-info">
                <div class="avatar">
                    <img src="/static/avatars/smile_1.png" alt="User Avatar">
                </div>
                <div class="user-details">
                    <span class="username">Guest</span>
                    <span class="status">Online</span>
                </div>
                <button class="settings-btn" onclick="openUserSettings()" title="User Settings">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="settings-compact-mode">
                        Compact Mode
                    </label>
                    <small>Show more messages on screen</small>
                </div>

                 <div class="form-group">
                     <label>
                         <input type="checkbox" id="settings-show-timestamps">
                         Show Timestamps
                     </label>
                     <small>Display message timestamps</small>
                 </div>

                  <div class="form-group">
                      <label>
                          <input type="checkbox" id="settings-animated-bg">
                          Animated Background
                      </label>
                      <small>Enable subtle moving background pattern</small>
                  </div>

                  <div class="form-group">
                      <label for="settings-cursor-effect">Cursor Effect</label>
                      <select id="settings-cursor-effect">
                          <option value="none">None</option>
                          <option value="orbiting">Orbiting Pastas</option>
                          <option value="falling">Falling Pastas</option>
                      </select>
                      <small>Choose the cursor particle effect</small>
                  </div>
              </div>

            <div id="settings-tab-privacy" class="settings-tab-content" style="display: none;">
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="settings-allow-dms">
                        Allow Direct Messages
                    </label>
                    <small>Let other users send you private messages</small>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="settings-show-online-status">
                        Show Online Status
                    </label>
                    <small>Let others see when you're online</small>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="settings-typing-indicators">
                        Send Typing Indicators
                    </label>
                    <small>Let others know when you're typing</small>
                </div>
            </div>

            <div class="settings-actions">
                <button type="button" class="save-settings-btn">Save Changes</button>
                <button type="button" class="cancel-button" onclick="closeUserSettings()">Close</button>
            </div>
        </div>
    </div>

     <div id="voice-warning-modal" class="modal" style="display: none;">
         <div class="modal-content">
             <h2>Voice Unavailable</h2>
             <p>Voice is unavailable until solutions are found. Thanks!</p>
             <div class="form-actions">
                 <button type="button" class="cancel-button">OK</button>
             </div>
         </div>
     </div>

     <div id="adventurer-recruit-modal" class="modal" style="display: none;">
         <div class="modal-content">
             <h2>Recruit Adventurer</h2>
             <div class="adventurer-classes">
                 <div class="class-category">
                     <h3>Melee</h3>
                     <div class="class-options">
                         <button class="class-btn" data-class="stealth">Stealth (50 Gold)</button>
                         <button class="class-btn" data-class="finesse">Finesse (50 Gold)</button>
                         <button class="class-btn" data-class="brute">Brute (50 Gold)</button>
                     </div>
                 </div>
                 <div class="class-category">
                     <h3>Healer</h3>
                     <div class="class-options">
                         <button class="class-btn" data-class="cleric">Cleric (60 Gold)</button>
                         <button class="class-btn" data-class="spirit">Spirit (60 Gold)</button>
                         <button class="class-btn" data-class="nature">Nature (60 Gold)</button>
                     </div>
                 </div>
                 <div class="class-category">
                     <h3>Caster</h3>
                     <div class="class-options">
                         <button class="class-btn" data-class="arcane">Arcane (70 Gold)</button>
                         <button class="class-btn" data-class="summoner">Summoner (70 Gold)</button>
                         <button class="class-btn" data-class="enchanter">Enchanter (70 Gold)</button>
                     </div>
                 </div>
                 <div class="class-category">
                     <h3>Hybrid</h3>
                     <div class="class-options">
                         <button class="class-btn" data-class="bard">Bard (80 Gold)</button>
                         <button class="class-btn" data-class="knight">Knight (80 Gold)</button>
                         <button class="class-btn" data-class="tamer">Tamer (80 Gold)</button>
                     </div>
                 </div>
             </div>
             <div class="form-actions">
                 <button type="button" class="cancel-button" onclick="closeAdventurerRecruitModal()">Cancel</button>
             </div>
         </div>
     </div>

    <div id="dice-modal" class="modal" style="display: none;">
        <div class="modal-content dice-modal-content">
            <button class="close-modal" onclick="closeDiceModal()">&times;</button>
            <h2>üé≤ Roll Dice</h2>
            
            <div class="dice-tabs">
                <div class="dice-tab active" data-tab="standard">Standard D&D</div>
                <div class="dice-tab" data-tab="custom">Custom</div>
            </div>
            
            <div id="dice-tab-standard" class="dice-tab-content">
                <div class="dice-grid">
                    <button class="dice-btn" data-sides="4">
                        <span class="dice-icon">üî∂</span>
                        <span class="dice-label">d4</span>
                    </button>
                    <button class="dice-btn" data-sides="6">
                        <span class="dice-icon">‚öÅ</span>
                        <span class="dice-label">d6</span>
                    </button>
                    <button class="dice-btn" data-sides="8">
                        <span class="dice-icon">üî∏</span>
                        <span class="dice-label">d8</span>
                    </button>
                    <button class="dice-btn" data-sides="10">
                        <span class="dice-icon">üîü</span>
                        <span class="dice-label">d10</span>
                    </button>
                    <button class="dice-btn" data-sides="100">
                        <span class="dice-icon">üíØ</span>
                        <span class="dice-label">d10%</span>
                    </button>
                    <button class="dice-btn" data-sides="12">
                        <span class="dice-icon">üî∑</span>
                        <span class="dice-label">d12</span>
                    </button>
                    <button class="dice-btn" data-sides="20">
                        <span class="dice-icon">üé≤</span>
                        <span class="dice-label">d20</span>
                    </button>
                </div>
                
                <div class="dice-options">
                    <div class="dice-input-group">
                        <label for="dice-count">Number of Dice</label>
                        <input type="number" id="dice-count" min="1" max="20" value="1">
                    </div>
                    <div class="dice-input-group">
                        <label for="dice-modifier">Modifier</label>
                        <input type="number" id="dice-modifier" value="0" placeholder="+/-">
                    </div>
                </div>
            </div>
            
            <div id="dice-tab-custom" class="dice-tab-content" style="display: none;">
                <div class="dice-input-group">
                    <label for="custom-dice-sides">Number of Sides</label>
                    <input type="number" id="custom-dice-sides" min="2" max="1000" value="20">
                </div>
                <div class="dice-input-group">
                    <label for="custom-dice-count">Number of Dice</label>
                    <input type="number" id="custom-dice-count" min="1" max="20" value="1">
                </div>
                <div class="dice-input-group">
                    <label for="custom-dice-modifier">Modifier</label>
                    <input type="number" id="custom-dice-modifier" value="0" placeholder="+/-">
                </div>
                <button class="roll-custom-dice-btn">Roll Custom Dice</button>
            </div>
            
            <div class="current-roll" style="display: none;">
                <h3>Current Roll:</h3>
                <div class="roll-display">
                    <span class="roll-formula"></span>
                    <span class="roll-result"></span>
                </div>
                <button class="send-roll-btn">Send to Chat</button>
            </div>
        </div>
    </div>

    <div id="app-container" class="app-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>LAN Chat</h1>
            </div>
            <div class="channel-category">
                <div class="category-header">
                    <h3>TEXT CHANNELS</h3>
                    <button class="add-channel-btn" onclick="showCreateChannelModal()" title="Create Channel">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div id="channels-list">
                    <div class="channel active" data-channel="general">
                        <i class="fas fa-hashtag"></i><span>general</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="user-info" onclick="openUserSettings()" title="User Settings" style="cursor: pointer;">
            <div class="avatar">
                <img src="/static/avatars/smile_1.png" alt="User Avatar">
            </div>
            <div class="user-details">
                <span class="username">Guest</span>
                <span class="status">Online</span>
            </div>
            <button class="settings-btn" onclick="event.stopPropagation(); openUserSettings()" title="User Settings">
                <i class="fas fa-cog"></i>
            </button>
        </div>

        <div class="main-content">
             <div class="tabs">
                 <div class="tab active" data-tab="channel">
                     <span>general</span>
                     <div class="channel-description">general discussion channel</div>
                 </div>
                 <div class="tab" data-tab="file-share">
                     <span>File Share</span>
                 </div>
                 <div class="tab" data-tab="media">
                     <span>Media</span>
                 </div>
                 <div class="tab" data-tab="adventure">
                     <span>Adventure</span>
                 </div>
             </div>

            <div id="tab-content-channel" class="tab-content">
                <div id="messages-container" class="messages-container">
                    <div class="welcome-message">
                        <h2>Sometimes things break.</h2>
                        <h2>Sometimes they get better.</h2>
                    </div>
                </div>
                <button id="new-messages-button" style="display: none;">New Messages</button>
                <div class="chat-input-container">
                    <div id="typing-indicator-bar" style="display: none;">
                        <span id="typing-text"></span>
                    </div>
                    <div class="reply-bar" style="display: none;"></div>
                    <div class="input-wrapper">
                        <textarea class="message-input" placeholder="Message #general"></textarea>
                        <div class="input-actions">
                            <input type="file" id="chat-file-upload-input" multiple style="display: none;" accept="image/png,image/webp,image/jpeg,image/gif,application/pdf,.doc,.docx,text/plain,.md,video/mp4,video/webm,video/avi,video/quicktime">
                            <button class="action-btn send-image-btn"><i class="fas fa-paper-plane"></i></button>
                            <button class="action-btn upload-btn"><i class="fas fa-upload"></i></button>
                            <button class="action-btn voice-btn"><i class="fas fa-microphone"></i> Voice</button>
                            <button class="action-btn dice-btn" onclick="openDiceModal()"><i class="fas fa-dice"></i> Dice</button>
                            <label class="auto-scroll-label">
                                <input type="checkbox" id="auto-scroll-checkbox"> Auto-Scroll
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-content-file-share" class="tab-content" style="display: none;">
                <div class="file-share-container">
                    <div class="file-share-controls">
                        <button class="upload-btn">Upload</button>
                        <button class="create-folder-btn">New Folder</button>
                        <input type="file" id="file-share-upload-input" multiple style="display: none;">
                    </div>
                    <div class="file-share-layout">
                        <div class="folder-tree">
                            <div class="folder-tree-header">
                                <h3>Folders</h3>
                            </div>
                            <div class="folder-tree-content" id="folder-tree-content">
                                <!-- Folder tree will be populated here -->
                            </div>
                        </div>
                        <div class="file-content">
                            <div class="current-folder-path" id="current-folder-path">
                                <i class="fas fa-folder"></i> Share
                            </div>
                            <div class="file-list" id="file-list">
                                <!-- Files will be displayed here -->
                </div>
            </div>
            <div class="user-info">
                <div class="avatar">
                    <img src="/static/avatars/smile_1.png" alt="User Avatar">
                </div>
                <div class="user-details">
                    <span class="username">Guest</span>
                    <span class="status">Online</span>
                </div>
                <button class="settings-btn" onclick="openUserSettings()" title="User Settings">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>
                </div>
            </div>

             <div id="tab-content-media" class="tab-content" style="display: none;">
                 <div class="media-upload-section">
                     <input type="file" id="media-upload-input" multiple accept="video/*,audio/*" style="display: none;">
                     <button class="upload-btn">Upload Media</button>
                 </div>
                 <div class="media-input-section">
                     <input type="text" id="media-url-input" placeholder="Enter YouTube/Video URL">
                     <button class="download-btn">Download</button>
                 </div>
                <div class="media-player-section">
                    <div class="media-player-container">
                        <video id="media-player-video" controls style="display: none;"></video>
                        <audio id="media-player-audio" controls style="display: none;"></audio>
                        <div class="player-placeholder">Select a media file to play</div>
                    </div>
                    <div class="media-controls">
                        <button id="play-pause-btn">Play</button>
                        <button id="stop-btn">Stop</button>
                    </div>
                </div>
                <div class="media-files-grid"></div>
             </div>

             <div id="tab-content-adventure" class="tab-content" style="display: none;">
                 <div class="adventure-container">
                     <div class="city-header">
                         <h2>Your City</h2>
                         <div class="city-resources">
                             <div class="resource">Gold: <span id="city-gold">0</span></div>
                             <div class="resource">Wood: <span id="city-wood">0</span></div>
                             <div class="resource">Stone: <span id="city-stone">0</span></div>
                             <div class="resource">Food: <span id="city-food">0</span></div>
                         </div>
                     </div>

                     <div class="city-sections">
                         <div class="city-section">
                             <h3>Villagers</h3>
                             <div id="villagers-list" class="units-list">
                                 <!-- Villagers will be populated here -->
                             </div>
                             <button class="recruit-btn" onclick="recruitVillager()">Recruit Villager (10 Gold)</button>
                         </div>

                         <div class="city-section">
                             <h3>Adventurers</h3>
                             <div id="adventurers-list" class="units-list">
                                 <!-- Adventurers will be populated here -->
                             </div>
                             <button class="recruit-btn" onclick="showAdventurerRecruitModal()">Recruit Adventurer</button>
                         </div>

                         <div class="city-section">
                             <h3>Guards</h3>
                             <div id="guards-list" class="units-list">
                                 <!-- Guards will be populated here -->
                             </div>
                             <button class="recruit-btn" onclick="recruitGuard()">Recruit Guard (25 Gold)</button>
                         </div>
                     </div>

                     <div class="city-actions">
                         <button onclick="viewOtherCities()">View Other Cities</button>
                         <button onclick="sendMission()">Send Mission</button>
                     </div>
                 </div>
             </div>
         </div>

         <div class="members-sidebar">
            <div class="member-header">
                <h3>MEMBERS - 0</h3>
            </div>
            <div class="member-group">
                <div class="member">
                    <div class="member-avatar">
                        <img src="/static/avatars/smile_1.png" alt="Avatar">
                        <div class="status-dot online"></div>
                    </div>
                    <div class="member-info">
                        <span class="member-name">Username</span>
                        <span class="member-status">Online</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/lib/socket.io.min.js"></script>
    <script src="/static/lib/moment.min.js"></script>
    <script src="/static/core.js"></script>
    <script src="/static/viewers.js"></script>
    <script src="/static/login.js"></script>
    <script src="/static/socketEvents.js"></script>
    <script src="/static/thumbnailLoader.js"></script>
    <script src="/static/messageUtils.js"></script>
    <script src="/static/chatInput.js"></script>
    <script src="/static/file_share.js"></script>
    <script src="/static/effects.js"></script>
    <script src="/static/userSettings.js"></script>
     <script src="/static/channels.js"></script>
     <script src="/static/media.js"></script>
     <script src="/static/adventure.js"></script>
     <script src="/static/dice.js"></script>
 </body>
 </html>